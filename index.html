<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Score Tracker</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.9.1/gsap.min.js"></script>
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #f9f9f9;
            text-align: center;
            padding: 20px;
            transition: background-color 0.3s, color 0.3s;
        }
        .dark-mode {
            background-color: #121212;
            color: white;
        }
        h2 {
            color: #333;
            font-size: 36px;
            letter-spacing: 1px;
            animation: fadeIn 1s ease-in-out;
        }
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        input, button {
            padding: 12px;
            margin: 8px;
            border: none;
            border-radius: 5px;
            transition: all 0.3s ease;
            font-size: 16px;
        }
        button {
            background-color: #007BFF;
            color: white;
            cursor: pointer;
            transform: scale(1);
        }
        button:hover {
            background-color: #0056b3;
            transform: scale(1.05);
        }
        .dark-mode button {
            background-color: #444;
            color: white;
        }
        .dark-mode button:hover {
            background-color: #666;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
            background: white;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
            border-radius: 10px;
            overflow: hidden;
            animation: slideUp 0.5s ease-in-out;
        }
        .dark-mode table {
            background-color: #333;
            color: white;
        }
        @keyframes slideUp {
            from { transform: translateY(20px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }
        th, td {
            border: 1px solid #ddd;
            padding: 12px;
            text-align: center;
            transition: background-color 0.3s, color 0.3s;
        }
        th {
            background-color: #007BFF;
            color: white;
        }
        .dark-mode th {
            background-color: #444;
            color: white;
        }
        input[type="number"] {
            width: 60px;
            text-align: center;
            transition: background-color 0.3s;
        }
        .dark-mode input[type="number"] {
            background-color: #555;
            color: white;
        }
        #darkModeToggle {
            margin-top: 20px;
            padding: 12px;
            cursor: pointer;
            background-color: #333;
            color: white;
            border-radius: 5px;
            transition: background-color 0.3s ease, transform 0.3s ease;
        }
        #darkModeToggle:hover {
            background-color: #555;
            transform: scale(1.05);
        }

        /* Ensuring player name input and button are on the same line */
        #inputContainer {
            display: flex;
            justify-content: center;
            align-items: center;
            margin-bottom: 20px;
        }
        #inputContainer input {
            width: 250px;
        }

        /* Confirmation Modal */
        #clearDataModal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            justify-content: center;
            align-items: center;
            z-index: 9999;
        }
        #clearDataModal .modalContent {
            background-color: white;
            padding: 20px;
            border-radius: 8px;
            text-align: center;
            max-width: 300px;
            width: 100%;
        }
        #clearDataModal .modalContent button {
            margin: 10px;
        }

        /* Mobile Responsive Table */
        @media (max-width: 768px) {
            .table-container {
                overflow-x: auto;
                width: 100%;
            }
            table {
                min-width: 600px; /* Ensures the table is wide enough to scroll */
            }
        }
    </style>
</head>
<body>
    <h2>Player Score Tracker</h2>
    <button id="startButton" onclick="startGame()">Start Game</button>
    <button id="endButton" onclick="endGame()" style="display: none;">End Game</button>
    
    <!-- Player name input container -->
    <div id="inputContainer">
        <label for="playerName" id="playerNameLabel">Player Name:</label>
        <input type="text" id="playerName" placeholder="Enter name">
        <button id="addPlayerButton" onclick="addPlayer()">Add Player</button>
    </div>
    
    <p id="errorMessage" style="color: red; display: none;">Please enter exactly 4 players to start the game.</p>
    
    <!-- Table Container for Horizontal Scrolling -->
    <div class="table-container">
        <table id="scoreTable">
            <thead>
                <tr>
                    <th>Player</th>
                    <th>Round 1</th>
                    <th>Round 2</th>
                    <th>Round 3</th>
                    <th>Round 4</th>
                    <th>Round 5</th>
                    <th>Round 6</th>
                    <th>Round 7</th>
                    <th>Round 8</th>
                    <th>Round 9</th>
                    <th>Round 10</th>
                    <th>Total</th>
                </tr>
            </thead>
            <tbody>
            </tbody>
        </table>
    </div>
    
    <button id="clearDataButton" onclick="confirmClearData()">Clear Data</button>
    <button id="darkModeToggle" onclick="toggleDarkMode()">Switch to Dark Mode</button>
    
    <!-- Confirmation Modal -->
    <div id="clearDataModal">
        <div class="modalContent">
            <p>Are you sure you want to clear all data?</p>
            <button onclick="clearData()">Yes, Clear</button>
            <button onclick="closeModal()">Cancel</button>
        </div>
    </div>

    <script>
        let gameStarted = false;
        let players = [];

        // Load saved game data from localStorage
        function loadGameData() {
            const savedData = JSON.parse(localStorage.getItem('gameData'));
            if (savedData && savedData.players) {
                players = savedData.players; // Load players data
                players.forEach(player => {
                    addPlayerToTable(player.name, player.scores);
                });
            }

            const gameState = JSON.parse(localStorage.getItem('gameState'));
            if (gameState && gameState.gameStarted) {
                gameStarted = true;
                document.getElementById("startButton").style.display = "none";
                document.getElementById("endButton").style.display = "inline-block";
                gsap.to("#startButton", { opacity: 0, duration: 0.5, height: 0, padding: 0, margin: 0 });
                gsap.to("#endButton", { opacity: 1, height: 'auto', padding: '12px', margin: '8px', duration: 0.5 });

                // Hide the player input and "Add Player" button
                gsap.to("#playerNameLabel", { opacity: 0, height: 0, padding: 0, margin: 0, duration: 0.5 });
                gsap.to("#playerName", { opacity: 0, height: 0, padding: 0, margin: 0, duration: 0.5 });
                gsap.to("#addPlayerButton", { opacity: 0, height: 0, padding: 0, margin: 0, duration: 0.5 });
            }
        }

        function startGame() {
            if (players.length !== 4) {
                document.getElementById("errorMessage").style.display = "block";
                return;
            }

            if (gameStarted) return;
            gameStarted = true;
            localStorage.setItem("gameState", JSON.stringify({ gameStarted }));

            // Button visibility changes
            gsap.to("#startButton", { opacity: 0, duration: 0.5, height: 0, padding: 0, margin: 0 });
            gsap.to("#endButton", { opacity: 1, height: 'auto', padding: '12px', margin: '8px', duration: 0.5 });

            document.getElementById("startButton").style.display = "none";
            document.getElementById("endButton").style.display = "inline-block";
            
            // Hide the player input and "Add Player" button
            gsap.to("#playerNameLabel", { opacity: 0, height: 0, padding: 0, margin: 0, duration: 0.5 });
            gsap.to("#playerName", { opacity: 0, height: 0, padding: 0, margin: 0, duration: 0.5 });
            gsap.to("#addPlayerButton", { opacity: 0, height: 0, padding: 0, margin: 0, duration: 0.5 });
        }

        function addPlayer() {
            const playerName = document.getElementById("playerName").value.trim();
            if (playerName && players.length < 4) {
                players.push({ name: playerName, scores: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0] });
                addPlayerToTable(playerName);
                document.getElementById("playerName").value = "";
                document.getElementById("errorMessage").style.display = "none";
            }
        }

        function addPlayerToTable(playerName, scores = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0]) {
            const tableBody = document.getElementById("scoreTable").getElementsByTagName("tbody")[0];
            const row = tableBody.insertRow();
            const cell1 = row.insertCell(0);
            cell1.innerHTML = playerName;
            for (let i = 0; i < 10; i++) {
                const cell = row.insertCell(i + 1);
                const input = document.createElement("input");
                input.type = "number";
                input.value = scores[i];
                input.addEventListener("input", function () {
                    updateTotal(row);
                });
                cell.appendChild(input);
            }
            updateTotal(row);
        }

        function updateTotal(row) {
            let total = 0;
            for (let i = 1; i <= 10; i++) {
                const score = row.cells[i].firstElementChild.value;
                total += parseInt(score) || 0;
            }
            row.cells[11].innerHTML = total;
        }

        function endGame() {
            localStorage.removeItem('gameData');
            localStorage.removeItem('gameState');
            location.reload();
        }

        function confirmClearData() {
            document.getElementById('clearDataModal').style.display = 'flex';
        }

        function clearData() {
            players = [];
            localStorage.removeItem('gameData');
            document.getElementById('scoreTable').getElementsByTagName('tbody')[0].innerHTML = '';
            document.getElementById('clearDataModal').style.display = 'none';
        }

        function closeModal() {
            document.getElementById('clearDataModal').style.display = 'none';
        }

        // Dark Mode Toggle Function
        function toggleDarkMode() {
            const darkModeEnabled = document.body.classList.toggle('dark-mode');
            const toggleButton = document.getElementById('darkModeToggle');
            if (darkModeEnabled) {
                toggleButton.innerHTML = "Switch to Light Mode";
            } else {
                toggleButton.innerHTML = "Switch to Dark Mode";
            }
        }

        // Load game data on page load
        window.onload = loadGameData;
    </script>
</body>
</html>
